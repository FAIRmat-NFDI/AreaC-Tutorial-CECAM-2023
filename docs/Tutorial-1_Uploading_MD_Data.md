# Example - uploading molecular dynamics data

## <center> **Tutorial 1: Uploading molecular dynamics data and examining the metadata** </center>

NOMAD currently supports 2 molecular dynamics codes: Gromacs and Lammps. Here, we will walk you through uploading data from a series of simulations run in Gromacs.

First, download the zip file with the simulation data:

[Download Test Data](/assets/md_tutorial_1/water_workflow.zip){ .md-button }

Take a minute to example the directory structure. If you are familiar with Gromacs you will immediately see the input/output from 3 simulations: an energy minimization (`Emin/`), an NPT equilibration (`Equil-NPT/`), and an NVT production run (`Prod-NVT/`). In the main directory, you will also see a .yaml file, which contains the NOMAD schema for connecting these 3 simulations into a workflow. This will be covered in Tutorial 2.

Now, upload this data to NOMAD following the instructions of the previous page.

<!-- Click **CREATE A NEW UPLOAD**, and then you can either drop the `water_workflow.zip` file directly or click **CLICK OR DROP FILES** to find the file within your file system. Note that there is currently a 32GB file size limit per upload. This will likely be expanded in the future, and exceptions can be received by contacting the NOMAD team. NOMAD's approach to the large data sets generated by molecular dynamics simulations is still under development. A deeper discussion of this topic is beyond the scope of this initial tutorial series, but will be addressed in the future. -->

TODO - Not sure if below is part of the previous discussion or better here.

At this point, NOMAD will unzip your upload and automatically detect all possible "main" files corresponding to output from supported codes (in this case, the `.log` file from each Gromacs simulation). NOMAD will then proceed to parse all the relevant simulation files and store the simulation data and *metadata* within the NOMAD *Metainfo* schema. In this case, the parsing should take ~ 30 seconds. You should now see the successfully processed data overview:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Processed_data_edited.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

TODO - maybe here I should move over the description of the various sections of the upload page?

Let's examine the production simulation by clicking the 3 dots to the right of the entry labeled `Prod-NVT/mdrun_Prod-NVT.log`, circled in green in the above image. You will now be on the **OVERVIEW** page for this entry, which aims to provide a simple description of this entry through visualizations of the system itself, some key observables, and some of the overarching metadata. The **OVERVIEW** page will be examined in detail in Tutorial 2. For now, we will focus on how the uploaded data is stored within the NOMAD repository. In addition to the **OVERVIEW** tab, there are 3 other tabs at the top of the page: **FILES**, **DATA**, and **LOGS**.

Click on the **FILES** tab. Here you will find all the raw data that was uploaded via the .zip file, retained within the original file system structure. The raw files are stored in the repository and can be downloaded at any time.

Now click on the **LOGS** tab. Here you will find some technical information about the data processing along with any warnings or errors that were raised by the NOMAD software.

Finally, click on the **DATA** tab. Here you can navigate through the NOMAD *Metainfo* for this entry, i.e., the processed and normalized version of the simulation data and metadata.

Navigate to section **run** &rarr; **program**, where we find some basic information about the simulation code (name and version):

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_Program.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

Now navigate to section **run** &rarr; **method**:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_Method.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

Under **atom_parameters** you will find a list of force-field-dependent atom attributes such as mass and charge. Under **force_field** &rarr; **model** &rarr; **contributions** you will find a list of intramolecular interactions defined for this simulation. The development of metadata for a more comprehensive storage of force fields in NOMAD is currently underway. Under **force_field** &rarr; **force_calculations** you will find some basic input parameters dealing with the calculation of forces in this simulation.

Navigate to section **run** &rarr; **system** &rarr; **0**:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_System_0.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

The **system** section holds the configurational information from this entry. The first item in this section, **0**, corresponds to the first saved configuration within the simulation trajectory. Now click on the atoms section:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_System_0_Atoms.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

There will be a prompt to ask if you would like to visualize the system. If you click yes, the particles within the simulation box will be displayed. (The visualizer can also be accessed with additional features in the **OVERVIEW** page). In the **atoms** section, various atom attributes are stored, e.g., the positions and velocities of each atom for this frame. Notice that the simulation trajectory is stored as a list of repeating dictionaries, as opposed to the typical dictionary of lists that may be found in trajectory analysis software, such as *MDAnalysis*. In short, this is done for consistency with data from other methods that are stored in the NOMAD repository. However, when working with the data from a particular entry, there are tools in NOMAD to easily convert the *Metainfo* to a more convenient format for analysis. More about this in Tutorial 3.

Now click on the **atoms_group** section:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_System_0_AtomsGroup.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

This section holds a hierarchical organization of the system (denoted in the following as the *topology*), based on the *bonds* defined in the force field used for this simulation. By default, the first level of this hierarchy contains *molecule groups*, which group together all molecules of the same type. Now, by clicking the **atoms_group** subsection of this group, you reach the next level down, which contains each molecule within the current molecule group. Similarly to these molecule groups and molecule levels, monomer groups and monomer levels will be defined for polymer systems. The individual atoms within each molecule are not explicitly stored within this hierarchy, but are simply referenced via their indices within the **atoms** section. Take a few minutes to examime this hierarchy and the stored quantities in more detail. Note that at the moment the hierarchy is only stored in the first entry of **system**.

Now go back and navigate to section **run** &rarr; **calculation** &rarr; **0**:

<div class="click-zoom">
    <label>
        <input type="checkbox">
        <img src="/assets/md_tutorial_1/Run_Calculation_0.png" alt="Uploads page" width="90%" title="Uploads page.">
    </label>
</div>

The **calculation** section contains any saved thermodynamic quantities that are a function of a single configuration, e.g., energy, pressure, temperature, etc., as well as any saved force information for the atoms within each configuration.

### <u> **Exercises** </u>

1. What are the oxygen and hydrogen atom types used in the force field for this simulation?

2. What is the step number of the last saved configuration of this simulation? What is the corresponding time for this configuration?

3. (CHALLENGE) Which thermostat is used for temperature coupling in this simulation? What is the frequency of temperature coupling?

